#!/bin/rc

#cpns copies namespace from process 1 to process 2
#this script requires the writable /proc/ns mod found in contrib/mycroftiv/writeprocns

riosafe=()
testonly=()

while (~ $1 -*){
	switch($1){
	case -t
		testonly=-t
		shift
	case -r
		riosafe=-r
		shift
	case *
		echo bad flag $1
		shift
	}
}

if(~ $2 ""){
	echo usage: cpns MODELpid TARGETpid
	exit
}

if(! test -e /proc/$1){
	echo process $1 does not exist!
	exit
}
if(! test -e /proc/$2){
	echo process $2 does not exist!
	exit
}

subns $testonly $riosafe $1 $2
addns $testonly $riosafe $1 $2

riosafe=()
testonly=()
